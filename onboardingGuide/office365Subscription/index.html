<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Cloudneeti Documentation"><meta name="author" content="The Cloudneeti Team"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.1.2, mkdocs-material-4.3.1"><title>Onboarding steps - Documentation</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content=""><script src="../../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,400i,700|&display=swap"><style>body,input{font-family:"Poppins","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../assets/fonts/material-icons.css"><link rel="stylesheet" href="../../stylesheets/extra.css"><script>window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-149855644-1", "docs.cloudneeti.com")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })</script><script async src="https://www.google-analytics.com/analytics.js"></script></head><body dir="ltr" data-md-color-primary="cloudneeti" data-md-color-accent="cloudneeti"><svg class="md-svg"><defs></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#office-365-onboarding-guide" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="../.." title="Documentation" class="md-header-nav__button md-logo md-custom-logo"><img src="../../images/logo.png" width="170" height="40"></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><!--<span class="md-header-nav__topic"><a href="../..">Documentation</a></span><span class="md-header-nav__topic">Onboarding steps</span>--></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="../.." title="Documentation" class="md-nav__button md-logo"><img src="../../images/logo.png" width="48" height="48"></a>Documentation</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1"><label class="md-nav__link" for="nav-1">Introduction</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-1">Introduction</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../gettingStarted/introduction/" title="Getting Started" class="md-nav__link">Getting Started</a></li><li class="md-nav__item"><a href="../../gettingStarted/productFeatures/" title="Product Features" class="md-nav__link">Product Features</a></li><li class="md-nav__item"><a href="../../gettingStarted/howItWorks/" title="How it works" class="md-nav__link">How it works</a></li><li class="md-nav__item"><a href="../../gettingStarted/cloudSecurityBestPractices/" title="Cloud Security Best Practices" class="md-nav__link">Cloud Security Best Practices</a></li><li class="md-nav__item"><a href="../../gettingStarted/deploymentArchitecture/" title="Deployment Architecture" class="md-nav__link">Deployment Architecture</a></li><li class="md-nav__item"><a href="../../gettingStarted/customerDataSecurity/" title="Customer Data Security" class="md-nav__link">Customer Data Security</a></li><li class="md-nav__item"><a href="../../gettingStarted/glossary/" title="Glossary" class="md-nav__link">Glossary</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"><label class="md-nav__link" for="nav-2">Try and Buy</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">Try and Buy</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../tryAndBuy/freeTrial/" title="Free Trial" class="md-nav__link">Free Trial</a></li><li class="md-nav__item"><a href="../../tryAndBuy/subscribeOnAzureMarketplace/" title="Buy on Azure Marketplace" class="md-nav__link">Buy on Azure Marketplace</a></li><li class="md-nav__item"><a href="../../tryAndBuy/subscribe/" title="Request a License" class="md-nav__link">Request a License</a></li><li class="md-nav__item"><a href="../../tryAndBuy/partnerCobranding/" title="Partner co-branding" class="md-nav__link">Partner co-branding</a></li><li class="md-nav__item"><a href="../../tryAndBuy/estimatePricing/" title="Estimate Pricing" class="md-nav__link">Estimate Pricing</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"><label class="md-nav__link" for="nav-3">Security Policies</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">Security Policies</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../gettingStarted/cloudSecurityBestPractices/" title="Cloud Security Best Practices" class="md-nav__link">Cloud Security Best Practices</a></li><li class="md-nav__item"><a href="../../securityPolicies/awsSecurityPolcies/" title="AWS Security Policies" class="md-nav__link">AWS Security Policies</a></li><li class="md-nav__item"><a href="../../securityPolicies/azureSecurityPolcies/" title="Azure Security Policies" class="md-nav__link">Azure Security Policies</a></li><li class="md-nav__item"><a href="../../securityPolicies/gcp_SecurityPolcies/" title="GCP Security Policies(Preview)" class="md-nav__link">GCP Security Policies(Preview)</a></li><li class="md-nav__item"><a href="../../securityPolicies/office365SecurityPolcies/" title="Office 365 Security Policies" class="md-nav__link">Office 365 Security Policies</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6"><label class="md-nav__link" for="nav-3-6">OS baselines</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-3-6">OS baselines</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../securityPolicies/osBaseline/centOSSecurityPolcies/" title="CentOS" class="md-nav__link">CentOS</a></li><li class="md-nav__item"><a href="../../securityPolicies/osBaseline/rhelSecurityPolcies/" title="RHEL" class="md-nav__link">RHEL</a></li><li class="md-nav__item"><a href="../../securityPolicies/osBaseline/ubuntuSecurityPolcies/" title="Ubuntu 18.04" class="md-nav__link">Ubuntu 18.04</a></li><li class="md-nav__item"><a href="../../securityPolicies/osBaseline/windows12SecurityPolcies/" title="Windows 2012 R2" class="md-nav__link">Windows 2012 R2</a></li><li class="md-nav__item"><a href="../../securityPolicies/osBaseline/windows16SecurityPolcies/" title="Windows 2016" class="md-nav__link">Windows 2016</a></li><li class="md-nav__item"><a href="../../securityPolicies/osBaseline/windows19SecurityPolcies/" title="Windows 2019" class="md-nav__link">Windows 2019</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7"><label class="md-nav__link" for="nav-3-7">Kubernetes</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-3-7">Kubernetes</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../securityPolicies/kubernetes/awsK8SSecurityPolcies/" title="AWS" class="md-nav__link">AWS</a></li><li class="md-nav__item"><a href="../../securityPolicies/kubernetes/azureK8SSecurityPolcies/" title="Azure" class="md-nav__link">Azure</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"><label class="md-nav__link" for="nav-4">Compliance Benchmarks</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Compliance Benchmarks</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../complianceBenchmarks/complianceBenchmarks/" title="Benchmarks" class="md-nav__link">Benchmarks</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked><label class="md-nav__link" for="nav-5">Onboarding Guide</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">Onboarding Guide</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../onboardingGuideOverview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2"><label class="md-nav__link" for="nav-5-2">Amazon Web Services</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-2">Amazon Web Services</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../amazonWebServiceAccounts/" title="Onboarding steps" class="md-nav__link">Onboarding steps</a></li><li class="md-nav__item"><a href="../awsEnableConfigBasedDataCollection/" title="Enable AWS Config Based Data Collection (optional)" class="md-nav__link">Enable AWS Config Based Data Collection (optional)</a></li><li class="md-nav__item"><a href="../awsVMBaselineConfiguration/" title="OS baseline (optional)" class="md-nav__link">OS baseline (optional)</a></li><li class="md-nav__item"><a href="../awsVulnerabilities/" title="Vulnerability (optional)" class="md-nav__link">Vulnerability (optional)</a></li><li class="md-nav__item"><a href="../configureCloudneetiAgentInEKS/" title="Amazon Elastic Kubernetes Service (Amazon EKS) (optional)" class="md-nav__link">Amazon Elastic Kubernetes Service (Amazon EKS) (optional)</a></li><li class="md-nav__item"><a href="../awsAccountHealthStatus/" title="AWS onboarding health status" class="md-nav__link">AWS onboarding health status</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3"><label class="md-nav__link" for="nav-5-3">Microsoft Azure</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-3">Microsoft Azure</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../azureSubscriptions/" title="Onboarding steps" class="md-nav__link">Onboarding steps</a></li><li class="md-nav__item"><a href="../grantAccessToAzureSubscriptionAdditionalRoles/" title="Additional roles" class="md-nav__link">Additional roles</a></li><li class="md-nav__item"><a href="../grantAccessToKeyVaults/" title="Key vaults" class="md-nav__link">Key vaults</a></li><li class="md-nav__item"><a href="../azureAdvancedSecurityConfigurations/" title="Advanced security configurations" class="md-nav__link">Advanced security configurations</a></li><li class="md-nav__item"><a href="../enableASCAuditPolicies/" title="Enable ASC audit policies" class="md-nav__link">Enable ASC audit policies</a></li><li class="md-nav__item"><a href="../azureOSBaseline/" title="OS baseline and vulnerability" class="md-nav__link">OS baseline and vulnerability</a></li><li class="md-nav__item"><a href="../azureVulnerability/" title="Vulnerability" class="md-nav__link">Vulnerability</a></li><li class="md-nav__item"><a href="../configureCloudneetiAgentInAKS/" title="Azure Kubernetes Service (AKS)" class="md-nav__link">Azure Kubernetes Service (AKS)</a></li><li class="md-nav__item"><a href="../azureAccountHealthStatus/" title="Azure onboarding health status" class="md-nav__link">Azure onboarding health status</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4"><label class="md-nav__link" for="nav-5-4">Google Cloud Platform (Preview)</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-4">Google Cloud Platform (Preview)</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../gcpOnboardingOverview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../gcpProject/" title="GCP Project" class="md-nav__link">GCP Project</a></li><li class="md-nav__item"><a href="../gcpOrganization/" title="GCP Organization" class="md-nav__link">GCP Organization</a></li><li class="md-nav__item"><a href="../gcpAnnexure/" title="Annexure" class="md-nav__link">Annexure</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5" checked><label class="md-nav__link" for="nav-5-5">Office 365</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-5">Office 365</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Onboarding steps</label><a href="./" title="Onboarding steps" class="md-nav__link md-nav__link--active">Onboarding steps</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">In this article</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#onboarding-steps" title="Onboarding Steps" class="md-nav__link">Onboarding Steps</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#required-roles" title="Required Roles" class="md-nav__link">Required Roles</a></li><li class="md-nav__item"><a href="#required-permissions" title="Required Permissions" class="md-nav__link">Required Permissions</a></li></ul></nav></li><li class="md-nav__item"><a href="#step-1-register-cloudneeti-application" title="STEP 1: Register Cloudneeti Application" class="md-nav__link">STEP 1: Register Cloudneeti Application</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#11-manual" title="1.1 Manual" class="md-nav__link">1.1 Manual</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#register-cloudneeti-application" title="Register Cloudneeti application" class="md-nav__link">Register Cloudneeti application</a></li><li class="md-nav__item"><a href="#add-client-secret" title="Add Client Secret" class="md-nav__link">Add Client Secret</a></li><li class="md-nav__item"><a href="#grant-admin-consent-for-api-permissions" title="Grant admin consent for API permissions" class="md-nav__link">Grant admin consent for API permissions</a></li></ul></nav></li><li class="md-nav__item"><a href="#12-automated" title="1.2 Automated" class="md-nav__link">1.2 Automated</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#prerequisites" title="Prerequisites" class="md-nav__link">Prerequisites</a></li><li class="md-nav__item"><a href="#register-cloudneeti-application_1" title="Register Cloudneeti Application" class="md-nav__link">Register Cloudneeti Application</a></li><li class="md-nav__item"><a href="#grant-admin-consent-for-api-permissions_1" title="Grant admin consent for API permissions" class="md-nav__link">Grant admin consent for API permissions</a></li></ul></nav></li><li class="md-nav__item"><a href="#13-collect-information" title="1.3 Collect Information" class="md-nav__link">1.3 Collect Information</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#azure-directory-id" title="Azure Directory ID" class="md-nav__link">Azure Directory ID</a></li><li class="md-nav__item"><a href="#azure-ad-domain-name" title="Azure AD Domain Name" class="md-nav__link">Azure AD Domain Name</a></li><li class="md-nav__item"><a href="#registered-cloudneeti-application-id" title="Registered Cloudneeti Application ID" class="md-nav__link">Registered Cloudneeti Application ID</a></li><li class="md-nav__item"><a href="#registered-cloudneeti-application-secret" title="Registered Cloudneeti Application Secret" class="md-nav__link">Registered Cloudneeti Application Secret</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#step-2-add-office-365-subscription" title="STEP 2: Add Office 365 subscription" class="md-nav__link">STEP 2: Add Office 365 subscription</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#21-activate-the-license" title="2.1 Activate the License" class="md-nav__link">2.1 Activate the License</a></li><li class="md-nav__item"><a href="#22-add-cloud-account" title="2.2 Add Cloud Account" class="md-nav__link">2.2 Add Cloud Account</a></li><li class="md-nav__item"><a href="#23-data-collection" title="2.3 Data Collection" class="md-nav__link">2.3 Data Collection</a></li></ul></nav></li><li class="md-nav__item"><a href="#step-3-advanced-security-configurations" title="STEP 3: Advanced security configurations" class="md-nav__link">STEP 3: Advanced security configurations</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#31-collect-information" title="3.1 Collect Information" class="md-nav__link">3.1 Collect Information</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#cloudneeti-license-and-account-details" title="Cloudneeti license and account details" class="md-nav__link">Cloudneeti license and account details</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#license-id" title="License id" class="md-nav__link">License id</a></li><li class="md-nav__item"><a href="#account-id" title="Account id" class="md-nav__link">Account id</a></li></ul></nav></li><li class="md-nav__item"><a href="#office-365-details" title="Office 365 details" class="md-nav__link">Office 365 details</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#create-office-365-user" title="Create Office 365 user" class="md-nav__link">Create Office 365 user</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#1-create-office-365-user-with-roles-sharepoint-administrator-and-exchange-administrator" title="1. Create Office 365 user with roles SharePoint Administrator and Exchange Administrator" class="md-nav__link">1. Create Office 365 user with roles SharePoint Administrator and Exchange Administrator</a></li><li class="md-nav__item"><a href="#2-assign-user-with-compliance-manager-role" title="2. Assign User with Compliance Manager role" class="md-nav__link">2. Assign User with Compliance Manager role</a></li></ul></nav></li><li class="md-nav__item"><a href="#enable-mfa-and-create-application-password" title="Enable MFA and create application password" class="md-nav__link">Enable MFA and create application password</a></li></ul></nav></li><li class="md-nav__item"><a href="#generate-cloudneeti-api-key" title="Generate Cloudneeti API key" class="md-nav__link">Generate Cloudneeti API key</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#sign-up-on-cloudneeti-api-portal" title="Sign-up on Cloudneeti API portal." class="md-nav__link">Sign-up on Cloudneeti API portal.</a></li><li class="md-nav__item"><a href="#retrieve-and-activate-api-key" title="Retrieve and activate API key" class="md-nav__link">Retrieve and activate API key</a></li></ul></nav></li><li class="md-nav__item"><a href="#cloudneeti-artifacts-and-data-collector-details" title="Cloudneeti artifacts and data collector details" class="md-nav__link">Cloudneeti artifacts and data collector details</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#azure-details" title="Azure details" class="md-nav__link">Azure details</a></li><li class="md-nav__item"><a href="#azure-subscription-id" title="Azure Subscription ID" class="md-nav__link">Azure Subscription ID</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#32-provision-office-365-data-collector" title="3.2 Provision Office 365 data collector" class="md-nav__link">3.2 Provision Office 365 data collector</a></li><li class="md-nav__item"><a href="#33-apply-delete-lock" title="3.3 Apply delete lock" class="md-nav__link">3.3 Apply delete lock</a></li><li class="md-nav__item"><a href="#34-modify-the-data-collection-schedule" title="3.4 Modify the data collection schedule" class="md-nav__link">3.4 Modify the data collection schedule</a></li></ul></nav></li><li class="md-nav__item"><a href="#security-policies-that-require-permissions" title="Security Policies that Require Permissions" class="md-nav__link">Security Policies that Require Permissions</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#micorosft-graph-permission-devicemanagementconfigurationreadall" title="Micorosft graph permission - DeviceManagementConfiguration.Read.All" class="md-nav__link">Micorosft graph permission - DeviceManagementConfiguration.Read.All</a></li><li class="md-nav__item"><a href="#micorosft-graph-permission-applicationreadall" title="Micorosft graph permission - Application.Read.All" class="md-nav__link">Micorosft graph permission - Application.Read.All</a></li><li class="md-nav__item"><a href="#micorosft-graph-permission-userreadall" title="Micorosft graph permission - User.Read.All" class="md-nav__link">Micorosft graph permission - User.Read.All</a></li><li class="md-nav__item"><a href="#micorosft-graph-permission-devicemanagementappsreadall" title="Micorosft graph permission - DeviceManagementApps.Read.All" class="md-nav__link">Micorosft graph permission - DeviceManagementApps.Read.All</a></li><li class="md-nav__item"><a href="#advanced-security-configurations" title="Advanced security configurations" class="md-nav__link">Advanced security configurations</a></li></ul></nav></li><li class="md-nav__item"><a href="#offboarding" title="OFFBOARDING" class="md-nav__link">OFFBOARDING</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#delete-registered-cloudneeti-application" title="Delete registered Cloudneeti Application" class="md-nav__link">Delete registered Cloudneeti Application</a></li><li class="md-nav__item"><a href="#delete-office365-advanced-security-policy-data-collector" title="Delete Office365 Advanced Security Policy Data Collector" class="md-nav__link">Delete Office365 Advanced Security Policy Data Collector</a></li><li class="md-nav__item"><a href="#delete-cloud-account-in-cloudneeti-application" title="Delete cloud account in Cloudneeti application" class="md-nav__link">Delete cloud account in Cloudneeti application</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../office365AccountHealthStatus/" title="Office 365 onboarding health status" class="md-nav__link">Office 365 onboarding health status</a></li><li class="md-nav__item"><a href="../office365AdvanceSecurityConfigurationUpgrade/" title="Upgrade advanced security configurations" class="md-nav__link">Upgrade advanced security configurations</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"><label class="md-nav__link" for="nav-6">User Guide</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">User Guide</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../gettingStarted/signInAndSignOut/" title="Sign In and Sign Out" class="md-nav__link">Sign In and Sign Out</a></li><li class="md-nav__item"><a href="../../userGuide/userInterface/" title="User Interface" class="md-nav__link">User Interface</a></li><li class="md-nav__item"><a href="../../userGuide/dashboards/" title="Dashboards" class="md-nav__link">Dashboards</a></li><li class="md-nav__item"><a href="../../userGuide/securityPolicies/" title="Security Policies" class="md-nav__link">Security Policies</a></li><li class="md-nav__item"><a href="../../userGuide/complianceBenchmarks/" title="Compliance Benchmarks" class="md-nav__link">Compliance Benchmarks</a></li><li class="md-nav__item"><a href="../../userGuide/reports/" title="Reports" class="md-nav__link">Reports</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7"><label class="md-nav__link" for="nav-7">REST APIs</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-7">REST APIs</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../userGuide/restAPIs/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../userGuide/apiUserScenarios/" title="API User Scenarios" class="md-nav__link">API User Scenarios</a></li><li class="md-nav__item"><a href="../../userGuide/tokenAPI/" title="Token API" class="md-nav__link">Token API</a></li><li class="md-nav__item"><a href="../../userGuide/getLicenseAccounts/" title="License Accounts API" class="md-nav__link">License Accounts API</a></li><li class="md-nav__item"><a href="../../userGuide/onboardCloudAccount/" title="Onboard cloud account API" class="md-nav__link">Onboard cloud account API</a></li><li class="md-nav__item"><a href="../../userGuide/updateAPIAppAccessScope/" title="Update API app access scope API" class="md-nav__link">Update API app access scope API</a></li><li class="md-nav__item"><a href="../../userGuide/getHealthStatus/" title="Onboarding health status API" class="md-nav__link">Onboarding health status API</a></li><li class="md-nav__item"><a href="../../userGuide/getBenchmarkSummary/" title="Audit summary report API" class="md-nav__link">Audit summary report API</a></li><li class="md-nav__item"><a href="../../userGuide/initiateScanAPI/" title="Initiate scan API" class="md-nav__link">Initiate scan API</a></li><li class="md-nav__item"><a href="../../userGuide/scanStatusAPI/" title="Scan status API" class="md-nav__link">Scan status API</a></li><li class="md-nav__item"><a href="../../userGuide/getSupportedBenchmarks/" title="Get supported benchmarks API" class="md-nav__link">Get supported benchmarks API</a></li><li class="md-nav__item"><a href="../../userGuide/auditReportAPI/" title="Audit report API" class="md-nav__link">Audit report API</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8"><label class="md-nav__link" for="nav-8">Administrator Guide</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-8">Administrator Guide</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../administratorGuide/featuresAndQuotas/" title="Features and Quotas" class="md-nav__link">Features and Quotas</a></li><li class="md-nav__item"><a href="../../administratorGuide/manageLicenses/" title="Integrations" class="md-nav__link">Integrations</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3"><label class="md-nav__link" for="nav-8-3">Incident management</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-8-3">Incident management</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../administratorGuide/serviceNowIntegration/" title="Service Now" class="md-nav__link">Service Now</a></li><li class="md-nav__item"><a href="../../administratorGuide/zendeskIntegration/" title="Zendesk" class="md-nav__link">Zendesk</a></li></ul></nav></li><li class="md-nav__item"><a href="../../administratorGuide/azureASCPushIntegration/" title="ASC Push Integration" class="md-nav__link">ASC Push Integration</a></li><li class="md-nav__item"><a href="../../administratorGuide/manageAccounts/" title="Cloud Accounts" class="md-nav__link">Cloud Accounts</a></li><li class="md-nav__item"><a href="../../administratorGuide/manageUsers/" title="Users & Roles" class="md-nav__link">Users & Roles</a></li><li class="md-nav__item"><a href="../../administratorGuide/privateBenchmark/" title="Private Benchmark" class="md-nav__link">Private Benchmark</a></li><li class="md-nav__item"><a href="../../administratorGuide/securityPolicyExclusions/" title="Security Policy Configuration" class="md-nav__link">Security Policy Configuration</a></li><li class="md-nav__item"><a href="../../administratorGuide/overrideSecurityPolicyStatus/" title="Override Security Policy Status" class="md-nav__link">Override Security Policy Status</a></li><li class="md-nav__item"><a href="../../administratorGuide/auditLog/" title="Audit Log" class="md-nav__link">Audit Log</a></li><li class="md-nav__item"><a href="../../administratorGuide/configureCloudneetiAPIAccess/" title="Configure Cloudneeti API Access" class="md-nav__link">Configure Cloudneeti API Access</a></li><li class="md-nav__item"><a href="../../administratorGuide/utilizationDashboard/" title="Utilization Dashboard" class="md-nav__link">Utilization Dashboard</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"><label class="md-nav__link" for="nav-9">Remediation</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-9">Remediation</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../remediation/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2"><label class="md-nav__link" for="nav-9-2">Azure</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-9-2">Azure</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../remediation/azureGuidedRemediation/" title="Guided Remediation" class="md-nav__link">Guided Remediation</a></li><li class="md-nav__item"><a href="../../remediation/azureAutoRemediation/" title="Auto Remediation" class="md-nav__link">Auto Remediation</a></li><li class="md-nav__item"><a href="../../remediation/azureDecommissionofRemediation/" title="Decommission of remediation" class="md-nav__link">Decommission of remediation</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-3" type="checkbox" id="nav-9-3"><label class="md-nav__link" for="nav-9-3">AWS</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-9-3">AWS</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../remediation/awsGuidedRemediation/" title="Guided Remediation" class="md-nav__link">Guided Remediation</a></li><li class="md-nav__item"><a href="../../remediation/awsRemediation/" title="Auto Remediation" class="md-nav__link">Auto Remediation</a></li><li class="md-nav__item"><a href="../../remediation/awsDecommissionofRemediation/" title="Decommission Remediation Framework" class="md-nav__link">Decommission Remediation Framework</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10"><label class="md-nav__link" for="nav-10">Quick wins and OS baseline hardening scripts</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-10">Quick wins and OS baseline hardening scripts</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../remediation/overviewQuickWins/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../remediation/awsQuickWins/" title="AWS Quick wins" class="md-nav__link">AWS Quick wins</a></li><li class="md-nav__item"><a href="../../remediation/azureQuickWins/" title="Azure Quick Wins" class="md-nav__link">Azure Quick Wins</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-4" type="checkbox" id="nav-10-4"><label class="md-nav__link" for="nav-10-4">OS Hardening for Baseline Configuration</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-10-4">OS Hardening for Baseline Configuration</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../remediation/osBaseline/centOSQuickWins/" title="CentOS Linux 7" class="md-nav__link">CentOS Linux 7</a></li><li class="md-nav__item"><a href="../../remediation/osBaseline/rhelQuickWins/" title="RHEL Linux 7" class="md-nav__link">RHEL Linux 7</a></li><li class="md-nav__item"><a href="../../remediation/osBaseline/win12QuickWins/" title="Windows Server 2012 R2" class="md-nav__link">Windows Server 2012 R2</a></li><li class="md-nav__item"><a href="../../remediation/osBaseline/win16QuickWins/" title="Windows Server 2016" class="md-nav__link">Windows Server 2016</a></li><li class="md-nav__item"><a href="../../remediation/osBaseline/win19QuickWins/" title="Windows Server 2019" class="md-nav__link">Windows Server 2019</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11"><label class="md-nav__link" for="nav-11">Release Notes</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-11">Release Notes</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../releaseNotes/2020/" title="Releases in 2020" class="md-nav__link">Releases in 2020</a></li><li class="md-nav__item"><a href="../../releaseNotes/2019/" title="Releases in 2019" class="md-nav__link">Releases in 2019</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">In this article</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#onboarding-steps" title="Onboarding Steps" class="md-nav__link">Onboarding Steps</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#required-roles" title="Required Roles" class="md-nav__link">Required Roles</a></li><li class="md-nav__item"><a href="#required-permissions" title="Required Permissions" class="md-nav__link">Required Permissions</a></li></ul></nav></li><li class="md-nav__item"><a href="#step-1-register-cloudneeti-application" title="STEP 1: Register Cloudneeti Application" class="md-nav__link">STEP 1: Register Cloudneeti Application</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#11-manual" title="1.1 Manual" class="md-nav__link">1.1 Manual</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#register-cloudneeti-application" title="Register Cloudneeti application" class="md-nav__link">Register Cloudneeti application</a></li><li class="md-nav__item"><a href="#add-client-secret" title="Add Client Secret" class="md-nav__link">Add Client Secret</a></li><li class="md-nav__item"><a href="#grant-admin-consent-for-api-permissions" title="Grant admin consent for API permissions" class="md-nav__link">Grant admin consent for API permissions</a></li></ul></nav></li><li class="md-nav__item"><a href="#12-automated" title="1.2 Automated" class="md-nav__link">1.2 Automated</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#prerequisites" title="Prerequisites" class="md-nav__link">Prerequisites</a></li><li class="md-nav__item"><a href="#register-cloudneeti-application_1" title="Register Cloudneeti Application" class="md-nav__link">Register Cloudneeti Application</a></li><li class="md-nav__item"><a href="#grant-admin-consent-for-api-permissions_1" title="Grant admin consent for API permissions" class="md-nav__link">Grant admin consent for API permissions</a></li></ul></nav></li><li class="md-nav__item"><a href="#13-collect-information" title="1.3 Collect Information" class="md-nav__link">1.3 Collect Information</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#azure-directory-id" title="Azure Directory ID" class="md-nav__link">Azure Directory ID</a></li><li class="md-nav__item"><a href="#azure-ad-domain-name" title="Azure AD Domain Name" class="md-nav__link">Azure AD Domain Name</a></li><li class="md-nav__item"><a href="#registered-cloudneeti-application-id" title="Registered Cloudneeti Application ID" class="md-nav__link">Registered Cloudneeti Application ID</a></li><li class="md-nav__item"><a href="#registered-cloudneeti-application-secret" title="Registered Cloudneeti Application Secret" class="md-nav__link">Registered Cloudneeti Application Secret</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#step-2-add-office-365-subscription" title="STEP 2: Add Office 365 subscription" class="md-nav__link">STEP 2: Add Office 365 subscription</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#21-activate-the-license" title="2.1 Activate the License" class="md-nav__link">2.1 Activate the License</a></li><li class="md-nav__item"><a href="#22-add-cloud-account" title="2.2 Add Cloud Account" class="md-nav__link">2.2 Add Cloud Account</a></li><li class="md-nav__item"><a href="#23-data-collection" title="2.3 Data Collection" class="md-nav__link">2.3 Data Collection</a></li></ul></nav></li><li class="md-nav__item"><a href="#step-3-advanced-security-configurations" title="STEP 3: Advanced security configurations" class="md-nav__link">STEP 3: Advanced security configurations</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#31-collect-information" title="3.1 Collect Information" class="md-nav__link">3.1 Collect Information</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#cloudneeti-license-and-account-details" title="Cloudneeti license and account details" class="md-nav__link">Cloudneeti license and account details</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#license-id" title="License id" class="md-nav__link">License id</a></li><li class="md-nav__item"><a href="#account-id" title="Account id" class="md-nav__link">Account id</a></li></ul></nav></li><li class="md-nav__item"><a href="#office-365-details" title="Office 365 details" class="md-nav__link">Office 365 details</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#create-office-365-user" title="Create Office 365 user" class="md-nav__link">Create Office 365 user</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#1-create-office-365-user-with-roles-sharepoint-administrator-and-exchange-administrator" title="1. Create Office 365 user with roles SharePoint Administrator and Exchange Administrator" class="md-nav__link">1. Create Office 365 user with roles SharePoint Administrator and Exchange Administrator</a></li><li class="md-nav__item"><a href="#2-assign-user-with-compliance-manager-role" title="2. Assign User with Compliance Manager role" class="md-nav__link">2. Assign User with Compliance Manager role</a></li></ul></nav></li><li class="md-nav__item"><a href="#enable-mfa-and-create-application-password" title="Enable MFA and create application password" class="md-nav__link">Enable MFA and create application password</a></li></ul></nav></li><li class="md-nav__item"><a href="#generate-cloudneeti-api-key" title="Generate Cloudneeti API key" class="md-nav__link">Generate Cloudneeti API key</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#sign-up-on-cloudneeti-api-portal" title="Sign-up on Cloudneeti API portal." class="md-nav__link">Sign-up on Cloudneeti API portal.</a></li><li class="md-nav__item"><a href="#retrieve-and-activate-api-key" title="Retrieve and activate API key" class="md-nav__link">Retrieve and activate API key</a></li></ul></nav></li><li class="md-nav__item"><a href="#cloudneeti-artifacts-and-data-collector-details" title="Cloudneeti artifacts and data collector details" class="md-nav__link">Cloudneeti artifacts and data collector details</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#azure-details" title="Azure details" class="md-nav__link">Azure details</a></li><li class="md-nav__item"><a href="#azure-subscription-id" title="Azure Subscription ID" class="md-nav__link">Azure Subscription ID</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#32-provision-office-365-data-collector" title="3.2 Provision Office 365 data collector" class="md-nav__link">3.2 Provision Office 365 data collector</a></li><li class="md-nav__item"><a href="#33-apply-delete-lock" title="3.3 Apply delete lock" class="md-nav__link">3.3 Apply delete lock</a></li><li class="md-nav__item"><a href="#34-modify-the-data-collection-schedule" title="3.4 Modify the data collection schedule" class="md-nav__link">3.4 Modify the data collection schedule</a></li></ul></nav></li><li class="md-nav__item"><a href="#security-policies-that-require-permissions" title="Security Policies that Require Permissions" class="md-nav__link">Security Policies that Require Permissions</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#micorosft-graph-permission-devicemanagementconfigurationreadall" title="Micorosft graph permission - DeviceManagementConfiguration.Read.All" class="md-nav__link">Micorosft graph permission - DeviceManagementConfiguration.Read.All</a></li><li class="md-nav__item"><a href="#micorosft-graph-permission-applicationreadall" title="Micorosft graph permission - Application.Read.All" class="md-nav__link">Micorosft graph permission - Application.Read.All</a></li><li class="md-nav__item"><a href="#micorosft-graph-permission-userreadall" title="Micorosft graph permission - User.Read.All" class="md-nav__link">Micorosft graph permission - User.Read.All</a></li><li class="md-nav__item"><a href="#micorosft-graph-permission-devicemanagementappsreadall" title="Micorosft graph permission - DeviceManagementApps.Read.All" class="md-nav__link">Micorosft graph permission - DeviceManagementApps.Read.All</a></li><li class="md-nav__item"><a href="#advanced-security-configurations" title="Advanced security configurations" class="md-nav__link">Advanced security configurations</a></li></ul></nav></li><li class="md-nav__item"><a href="#offboarding" title="OFFBOARDING" class="md-nav__link">OFFBOARDING</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#delete-registered-cloudneeti-application" title="Delete registered Cloudneeti Application" class="md-nav__link">Delete registered Cloudneeti Application</a></li><li class="md-nav__item"><a href="#delete-office365-advanced-security-policy-data-collector" title="Delete Office365 Advanced Security Policy Data Collector" class="md-nav__link">Delete Office365 Advanced Security Policy Data Collector</a></li><li class="md-nav__item"><a href="#delete-cloud-account-in-cloudneeti-application" title="Delete cloud account in Cloudneeti application" class="md-nav__link">Delete cloud account in Cloudneeti application</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1 id="office-365-onboarding-guide">Office 365 Onboarding Guide</h1>
<h2 id="onboarding-steps">Onboarding Steps</h2>
<p>The following steps are required to onboard Office 365 to Cloudneeti
application.
    <img alt="onBoarding Steps" src="../../images/onboardingOffice365Subscription/Onboarding_Steps.png#thumbnail_1" /></p>
<p><strong>1. Registering Cloudneeti application</strong> includes registering the Cloudneeti
application with the Azure Active Directory (AD) tenant, providing access to
Microsoft Graph and granting admin consent to the Cloudneeti application.</p>
<p><strong>2. Adding the Office 365 subscription</strong> includes adding Office 365
subscription information to the respective Cloud Account and waiting until the
first data collection is complete.</p>
<p><strong>3. Advanced security configuration</strong> includes adding a script to the
customer’s Azure account and granting the required access rights.</p>
<p>Advanced security configurations (step 3) requires a Cloudneeti PowerShell agent
to be installed in an Azure subscription under the same tenant where the Office
365 subscription is located. The Cloudneeti PowerShell agent retrieves (A)
additional configuration information from the Office 365 subscription (there are
no Office 365 APIs to retrieve this information) and pushes (B) this information
as a JSON file to the Cloudneeti application.
    <img alt="Advanced Security Configuration" src="../../images/onboardingOffice365Subscription/Advanced_Security_Configuration.png#thumbnail" /></p>
<table>
<thead>
<tr>
<th>S. No.</th>
<th>Step</th>
<th>Product</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Register Cloudneeti application</td>
<td>Microsoft Azure AD</td>
<td>Global AD Administrator</td>
</tr>
<tr>
<td>2</td>
<td>Add Office 365 subscription</td>
<td>Cloudneeti</td>
<td>License Admin</td>
</tr>
<tr>
<td>3</td>
<td>Advanced security configurations (optional)</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>a. Create application password</td>
<td>Office 365 My Account portal</td>
<td>Global AD Administrator</td>
</tr>
<tr>
<td></td>
<td>b. Generate Cloudneeti API key</td>
<td>Cloudneeti API portal</td>
<td>License Admin</td>
</tr>
<tr>
<td></td>
<td>c. Provision M365 Data Collector to your Azure Subscription</td>
<td>Microsoft Azure</td>
<td>Subscription Owner or Azure Subscription Contributor</td>
</tr>
<tr>
<td></td>
<td>d .Apply delete lock</td>
<td>Microsoft Azure</td>
<td>Subscription Owner or Azure Subscription Contributor</td>
</tr>
</tbody>
</table>
<h3 id="required-roles">Required Roles</h3>
<p>People with the following roles are required to complete the Office 365
onboarding process.</p>
<table>
<thead>
<tr>
<th>Role</th>
<th>Product</th>
</tr>
</thead>
<tbody>
<tr>
<td>License Admin</td>
<td>Cloudneeti application</td>
</tr>
<tr>
<td>Global AD Administrator</td>
<td>Microsoft Azure AD</td>
</tr>
<tr>
<td>Global Administrator</td>
<td>Microsoft Office 365</td>
</tr>
<tr>
<td>Subscription Owner</td>
<td>Microsoft Azure</td>
</tr>
</tbody>
</table>
<p>The Cloudneeti application <strong>License Admin</strong> is assigned to an individual in the
customer’s organization who will be responsible for the configuration of the
respective Cloudneeti application License.</p>
<p>The Microsoft Azure <strong>Global AD Administrator</strong> role is required for App
Registration of the Cloudneeti application and granting access rights to the
Cloudneeti application.</p>
<p>Microsoft Office 365 <strong>Global Administrator</strong> role is required for App
Registration of the Cloudneeti application and granting access rights to the
Cloudneeti application.</p>
<p>For Advanced security configurations (optional) the following roles are required.</p>
<table>
<thead>
<tr>
<th><strong>Role</strong></th>
<th><strong>Product</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>License Admin</td>
<td>Cloudneeti application</td>
</tr>
<tr>
<td>Azure Subscription Owner or Azure Subscription Contributor</td>
<td>Microsoft Azure</td>
</tr>
</tbody>
</table>
<p>The Microsoft Azure <strong>Subscription Owner or Contributor</strong> role is required to
provision a PowerShell agent to pull advanced security configuration information
and ingest to the Cloudneeti application.</p>
<h3 id="required-permissions">Required Permissions</h3>
<p>The Cloudneeti application will be granted two read permissions to the Azure
AD and Cloudneeti Agent provisioned in Step 3 will require Office 365 Global Admin permission. Each
optional permission is linked to a number of security policies where this
permission is needed for data collection. If an optional permission is not
provided, Cloudneeti application will not collect the data for the related
policies. Security policies that require such permissions are listed later in
this document.</p>
<p>Login to <a href="https://portal.azure.com/" target="_blank">Azure Portal</a> with <strong>Global AD
Administrator</strong> associated to your Office 365 Subscription role.</p>
<table>
<thead>
<tr>
<th><strong>Object</strong></th>
<th><strong>Permission</strong></th>
<th><strong>Required Role</strong></th>
<th><strong>Step</strong></th>
<th><strong>Type</strong></th>
<th><strong>Policies</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Azure Active Directory</td>
<td>Organisation Read All Microsoft Graph permissions</td>
<td>Global AD Admin</td>
<td>STEP 1</td>
<td>mandatory</td>
<td>NA</td>
</tr>
<tr>
<td>Azure Active Directory</td>
<td>Security Events Read All Microsoft Graph permissions</td>
<td>Global AD Admin</td>
<td>STEP 1</td>
<td>mandatory</td>
<td>NA</td>
</tr>
<tr>
<td>Azure Active Directory</td>
<td>DeviceManagementConfiguration.Read.All Microsoft Graph permissions</td>
<td>Global AD Admin</td>
<td>STEP 1</td>
<td>Optional</td>
<td><a href="../../onboardingGuide/office365Subscription/#micorosft-graph-permission-devicemanagementconfigurationreadall">23</a></td>
</tr>
<tr>
<td>Azure Active Directory</td>
<td>Application Read All Microsoft Graph permissions</td>
<td>Global AD Admin</td>
<td>STEP 1</td>
<td>Optional</td>
<td><a href="../../onboardingGuide/office365Subscription/#micorosft-graph-permission-applicationreadall">2</a></td>
</tr>
<tr>
<td>Azure Active Directory</td>
<td>User Read All Microsoft Graph permissions</td>
<td>Global AD Admin</td>
<td>STEP 1</td>
<td>Optional</td>
<td><a href="../../onboardingGuide/office365Subscription/#micorosft-graph-permission-userreadall">2</a></td>
</tr>
<tr>
<td>Azure Active Directory</td>
<td>DeviceManagementApps.Read.All Microsoft Graph permissions</td>
<td>Global AD Admin</td>
<td>STEP 1</td>
<td>Optional</td>
<td><a href="../../onboardingGuide/office365Subscription/#micorosft-graph-permission-devicemanagementappsreadall">3</a></td>
</tr>
<tr>
<td>Cloudneeti Agent</td>
<td>Office 365 Global Administrator Access Permission</td>
<td>Subscription Owner</td>
<td>STEP 3</td>
<td>Optional</td>
<td><a href="../../onboardingGuide/office365Subscription/#advanced-security-configurations">42</a></td>
</tr>
</tbody>
</table>
<h2 id="step-1-register-cloudneeti-application">STEP 1: Register Cloudneeti Application</h2>
<p>The following steps are executed by the Microsoft Azure <strong>Global ADAdministrator</strong> role.</p>
<p>Cloudneeti application can be registered either manually or using automation
script.</p>
<h3 id="11-manual">1.1 Manual</h3>
<h4 id="register-cloudneeti-application">Register Cloudneeti application</h4>
<p>Login to <a href="https://portal.azure.com/" target="_blank">Azure Portal</a> with <strong>Global AD
Administrator</strong> associated to your Office 365 Subscription role.</p>
<ol>
<li>Select <strong>Azure Active Directory</strong> associated to your Office 365 Subscription
    in the primary menu</li>
<li>Select <strong>App Registrations</strong> in the secondary menu</li>
<li>Click on <strong>New Registration</strong>
    <img alt="New Registration" src="../../images/onboardingOffice365Subscription/New_Registration.png#thumbnail" /></li>
<li>Enter the name, for example "Cloudneeti"</li>
<li>Click <strong>Register</strong>
    <img alt="Register" src="../../images/onboardingOffice365Subscription/Register.png#thumbnail" /></li>
<li><strong>Copy to clipboard</strong> and paste the Application id to your notepad
    <img alt="Copy AppID" src="../../images/onboardingOffice365Subscription/Copy_AppID.png#thumbnail" /></li>
</ol>
<h4 id="add-client-secret">Add Client Secret</h4>
<ol>
<li>Click on <strong>new client secret</strong> in <strong>Certificates &amp; secrets</strong> section (1)</li>
<li>Add <strong>Description</strong> and select expiry time</li>
<li>Click on <strong>Add</strong> (2)</li>
<li><strong>Copy to clipboard</strong> (3) and paste the Client Secret to your notepad.
    <strong>Note:</strong> You will not be able to copy this value after you move away from
    this screen.
    <img alt="Certificates &amp; secrets" src="../../images/onboardingOffice365Subscription/Copy_to_Clipboard.png#thumbnail" /></li>
</ol>
<h4 id="grant-admin-consent-for-api-permissions">Grant admin consent for API permissions</h4>
<p>Add Microsoft Graph permissions and grant admin consent</p>
<p>The Microsoft graph permission <strong>Organisation.Read.All</strong> allows the app to read data in the organization's directory, such as user attributes, groups, and applications, without a signed-in user.</p>
<p>Microsoft graph permission <strong>SecurityEvents.Read.All</strong> allows the app to read Office 365 Secure Score data. </p>
<p>Microsoft graph <strong>DeviceManagementConfiguration.Read.All</strong> allows the app to read properties of Microsoft Intune-managed device configuration and device compliance policies and their assignment to groups.</p>
<p>Microsoft graph <strong>Application.Read.All</strong> allows the app to read properties of application.</p>
<p>Microsoft graph <strong>User.Read.All</strong> allows the app to read properties of users.</p>
<p>Microsoft graph <strong>DeviceManagementApps.Read.All</strong> allows the app to read properties of Microsoft Intune-managed application configuration and application compliance policies and their assignment to groups.</p>
<p>You can find more details about the Microsoft Graph API permission <a href="https://docs.microsoft.com/en-us/graph/permissions-reference" target="_blank">here</a>.</p>
<ol>
<li>Click <strong>API Permissions</strong></li>
<li>Select <strong>Microsoft Graph</strong>
    <img alt="API Permissions" src="../../images/onboardingOffice365Subscription/API_Permissions.png#thumbnail" /></li>
<li>Select <strong>Application</strong>
    <img alt="Application" src="../../images/onboardingOffice365Subscription/Application.png#thumbnail" /></li>
<li>Click <strong>Add permission</strong> and add the following information (1)</li>
</ol>
<table>
<thead>
<tr>
<th>API</th>
<th>Permission Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Microsoft.Graph</td>
<td>Directory.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#directory-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>SecurityEvents.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#security-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>DeviceManagementConfiguration.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#intune-device-management-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
</tbody>
</table>
<ol>
<li>Click <strong>Grant admin consent</strong> in the Grant consent section (2)
    <img alt="API Permission" src="../../images/onboardingOffice365Subscription/Grant_Admin_Consent.png#thumbnail" /></li>
</ol>
<h3 id="12-automated">1.2 Automated</h3>
<h4 id="prerequisites">Prerequisites</h4>
<p>The below steps are required for registering the Cloudneeti application in Azure
Tenant using PowerShell script.</p>
<table>
<thead>
<tr>
<th>Activity</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. Download and review <strong>PowerShell script</strong> for creation of the service principal</td>
<td>The PowerShell script is used to create a service principal in Azure Tenant AD: <a href="https://raw.githubusercontent.com/Cloudneeti/docs_cloudneeti/master/scripts/Create-ServicePrincipal-Office365Onboarding.ps1" target="_blank">Download Link.</a></td>
</tr>
<tr>
<td>2. <strong>Workstation:</strong> Ensure you have the latest PowerShell version (v5 and above)</td>
<td>Verify PowerShell version by running the following command<br><code>$PSVersionTable.PSVersion</code><br>on the workstation where you will run the ServicePrincipal creation script. If the PowerShell version is lower than 5, then follow this link for installation of a later version: <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-windows-powershell?view=powershell-6" target="_blank">Download Link.</a></td>
</tr>
<tr>
<td>3. <strong>Workstation:</strong> Before executing the script, make sure there are no restrictions in running the PowerShell script</td>
<td>Use this PowerShell command:<br><code>Set-ExecutionPolicy `</code><br><code>-Scope Process `</code><br><code>-ExecutionPolicy Bypass</code><br>PowerShell contains built-in execution policies that limit its use as an attack vector. By default, the execution policy is set to Restricted, which is the primary policy for script execution. The bypass allows for running scripts and keeps the lowered permissions isolated to just the current running process.</td>
</tr>
<tr>
<td>4. <strong>Workstation:</strong> Install Azure Modules to execute PowerShell commands within service principal automation script</td>
<td><code>Install-Module `</code><br><code>-Name AzureAD `</code><br><code>-MinimumVersion 2.0.0.131</code><br>It is a roll-up module for the Azure Resource Manager cmdlets.</td>
</tr>
</tbody>
</table>
<h4 id="register-cloudneeti-application_1">Register Cloudneeti Application</h4>
<p>Use the Create-ServicePrincipal-Office365Onboarding.ps1 script to create and
register a Cloudneeti Application.</p>
<ol>
<li>
<p>Open PowerShell in administrator mode.</p>
</li>
<li>
<p>Go to the directory where Create-ServicePrincipal-Office365Onboarding.ps1
    was downloaded earlier.</p>
</li>
<li>
<p>Run the below command to create a service principal
    <pre>
        <code><code>.\Create-ServicePrincipal-Office365Onboarding.ps1 `
            -azureActiveDirectoryId &lt;Active_Directory_Id&gt; `
            -servicePrincipalName &lt;data_collector_name&gt; `
            -expirationPeriod 1year</code></code>
    </pre></p>
</li>
<li>The script will prompt the login screen</li>
<li>Log in with Global AD Administrator or Application Administrator user
    credentials.</li>
<li>Store service principal information from the output in a notepad. This
    information will be needed while onboarding the Azure account in the
    Cloudneeti portal.
    <img alt="Register Cloudneeti Application" src="../../images/onboardingOffice365Subscription/Register_Cloudneeti_Application.png#thumbnail" /></li>
</ol>
<h4 id="grant-admin-consent-for-api-permissions_1">Grant admin consent for API permissions</h4>
<p>The Azure <strong>Global AD Administrator</strong> needs to grant permissions to the
Cloudneeti application to be able to collect the Azure AD data.</p>
<ol>
<li>
<p>Click <strong>Azure Active Directory</strong></p>
</li>
<li>
<p>Click <strong>App registrations</strong></p>
</li>
<li>
<p>Find and select Cloudneeti application under Display Name</p>
</li>
<li>
<p>Go to <strong>API permissions</strong></p>
</li>
<li>
<p>Click <strong>Grant admin consent</strong> in the Grant consent section</p>
</li>
<li>
<p>Review permissions as below listed (1)</p>
<table>
<thead>
<tr>
<th>API</th>
<th>Permission Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Microsoft.Graph</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Organization.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#organization-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
<td></td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>SecurityEvents.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#security-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>DeviceManagementConfiguration.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#intune-device-management-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>DeviceManagementApps.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#intune-device-management-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>Application.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#application-resource-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
<tr>
<td>Microsoft.Graph</td>
<td>User.Read.All <a href="https://docs.microsoft.com/en-us/graph/permissions-reference#user-permissions" target="_blank">Refer here</a></td>
<td>Application</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Click <strong>Grant admin consent</strong> in the Grant consent section (2)
    <img alt="Grant_Admin_Consent" src="../../images/onboardingOffice365Subscription/Grant_Admin_Consent.png#thumbnail" /></p>
</li>
</ol>
<h3 id="13-collect-information">1.3 Collect Information</h3>
<p>The Cloudneeti application <strong>License Admin</strong> requires this information to add an
Azure subscription as a cloud account.</p>
<table>
<thead>
<tr>
<th>Information</th>
<th>Portal to use</th>
<th>User</th>
</tr>
</thead>
<tbody>
<tr>
<td>Azure Directory ID</td>
<td>Microsoft Azure</td>
<td>Subscription Owner</td>
</tr>
<tr>
<td>Azure Directory Domain name</td>
<td>Microsoft Azure</td>
<td>Subscription Owner</td>
</tr>
<tr>
<td>Registered Cloudneeti Application ID</td>
<td>Microsoft Azure</td>
<td>Subscription Owner</td>
</tr>
<tr>
<td>Registered Cloudneeti Application Secret</td>
<td>Microsoft Azure</td>
<td>Subscription Owner</td>
</tr>
</tbody>
</table>
<h4 id="azure-directory-id">Azure Directory ID</h4>
<ol>
<li>Click on <strong>Azure Active Directory</strong> on the primary menu</li>
<li>Click on <strong>Properties</strong> on the secondary menu</li>
<li>Copy <strong>Directory ID</strong> to a notepad
    <img alt="Directory ID" src="../../images/onboardingOffice365Subscription/Directory_ID.png#thumbnail" /></li>
</ol>
<h4 id="azure-ad-domain-name">Azure AD Domain Name</h4>
<ol>
<li>Click on <strong>Azure Active Directory</strong> on the primary menu</li>
<li>Click on <strong>Overview</strong> on the secondary menu</li>
<li>Copy <strong>Domain name</strong> to a notepad
    <img alt="Azure Domain Name" src="../../images/onboardingOffice365Subscription/Azure_Domain_Name.png#thumbnail" /></li>
</ol>
<h4 id="registered-cloudneeti-application-id">Registered Cloudneeti Application ID</h4>
<ol>
<li>Select <strong>Azure Active Directory</strong> in the primary menu</li>
<li>Select <strong>App Registrations</strong> in the secondary menu</li>
<li>Select Cloudneeti Application registered in <a href=".././onboardingOffice365Subscription/#step-1-register-cloudneeti-application">Step 1</a>
    <img alt="Registered Cloudneeti Application ID" src="../../images/onboardingOffice365Subscription/Cloudneeti_Application_ID.png#thumbnail" /></li>
<li>Copy the Cloudneeti Application id
    <img alt="Cloudneeti Application id" src="../../images/onboardingOffice365Subscription/Copy_AppID.png#thumbnail" /></li>
</ol>
<h4 id="registered-cloudneeti-application-secret">Registered Cloudneeti Application Secret</h4>
<ol>
<li>Select <strong>Azure Active Directory</strong> in the primary menu</li>
<li>Select <strong>App Registrations</strong> in the secondary menu</li>
<li>Select Cloudneeti Application registered in <a href=".././onboardingOffice365Subscription/#step-1-register-cloudneeti-application">Step 1</a></li>
<li>Click on <strong>new client secret</strong> in <strong>Certificates &amp; secrets</strong> section (1)</li>
<li>Add <strong>Description</strong> and select expiry time</li>
<li>Click on <strong>Add</strong> (2)</li>
<li><strong>Copy to clipboard</strong> and paste the Client Secret to your notepad. <strong>Note:</strong>
    You will not be able to copy this value after you move away from this
    screen. (3)
    <img alt="Registered Cloudneeti Application Secret" src="../../images/onboardingOffice365Subscription/Copy_to_Clipboard.png#thumbnail" /></li>
</ol>
<h2 id="step-2-add-office-365-subscription">STEP 2: Add Office 365 subscription</h2>
<p>The following steps are done by the Cloudneeti application <strong>License Admin</strong>
role.</p>
<h3 id="21-activate-the-license">2.1 Activate the License</h3>
<ol>
<li>Log in to the Cloudneeti application with <strong>License Admin</strong> role.</li>
<li>Click on <strong>Activate License</strong>
    <img alt="Activate License" src="../../images/onboardingOffice365Subscription/Activate_License.png#thumbnail" /></li>
</ol>
<h3 id="22-add-cloud-account">2.2 Add Cloud Account</h3>
<ol>
<li>Select cloud connector for <strong>Office 365</strong>
    <img alt="Add Cloud Account" src="../../images/onboardingOffice365Subscription/Add_Cloud_Account.png#thumbnail" /></li>
<li>Fill in the Account Name, Domain name, Azure Tenant Id (Domain ID) Azure
    Application ID and Azure Application Password.</li>
<li>Click on <strong>Add Account</strong>
    <img alt="Add Account" src="../../images/onboardingOffice365Subscription/Add_Account.png#thumbnail" /></li>
<li>You receive a confirmation that Office 365 has been added and data
    collection started.
    <img alt="confirmation" src="../../images/onboardingOffice365Subscription/Confirmation.png#thumbnail" /></li>
</ol>
<h3 id="23-data-collection">2.3 Data Collection</h3>
<p>Once Azure subscription is added to the cloud account under Cloudneeti License,
it requires about 5 minutes for the data to be collected and processed, before
they can be displayed in Cloudneeti dashboards.</p>
<ol>
<li>Select <strong>Dashboard</strong> on the menu</li>
<li>Review the data on dashboard
    <img alt="Dashboard" src="../../images/onboardingOffice365Subscription/Dashboard.png#thumbnail" /></li>
</ol>
<h2 id="step-3-advanced-security-configurations">STEP 3: Advanced security configurations</h2>
<p><strong>This step is optional.</strong></p>
<p>The following steps are done by Microsoft Azure <strong>Subscription Owner (or
Subscription Contributor)</strong> role.</p>
<p>An Azure Automation Account resource is deployed to collect data for additional
security policies. The Office 365 control plane exposes the data only through
PowerShell that needs to run under a Global AD administrator credential (with
MFA access).</p>
<p>To ensure that Cloudneeti does not ever store/have access to a global AD
administrator, it is recommended to deploy a small PowerShell script under
customer’s control in their own Azure subscription. The metadata collected after
running a script is then pushed to a Cloudneeti API that you registered during
the Cloudneeti API key generation.</p>
<h3 id="31-collect-information">3.1 Collect Information</h3>
<table>
<thead>
<tr>
<th><strong>Information</strong></th>
<th><strong>Source / Portal to use</strong></th>
<th><strong>User</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=".././office365Subscription/#license-id">Cloudneeti License Id</a></td>
<td>Cloudneeti</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#account-id">Cloudneeti Account Id </a></td>
<td>Cloudneeti</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#azure-directory-id">Office Directory Id  </a></td>
<td>Cloudneeti</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#registered-cloudneeti-application-id">Cloudneeti Application Id </a></td>
<td>Cloudneeti</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#cloudneeti-artifacts-and-data-collector-details">Cloudneeti Environment </a></td>
<td>Cloudneeti Team</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#generate-cloudneeti-api-key">Cloudneeti API key</a></td>
<td>Cloudneeti Team</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#cloudneeti-artifacts-and-data-collector-details">Artifacts Name </a></td>
<td>Cloudneeti Team</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#cloudneeti-artifacts-and-data-collector-details">Data Collector Version </a></td>
<td>Cloudneeti Team</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#cloudneeti-artifacts-and-data-collector-details">Cloudneeti M365 data collector artifacts storage access Key</a></td>
<td>Cloudneeti Team</td>
<td>License Admin</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#registered-cloudneeti-application-secret">Cloudneeti data collector Service Principal secret</a></td>
<td>Microsoft Azure</td>
<td>Subscription Owner</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#azure-subscription-id">Azure Subscription Id </a></td>
<td>Microsoft Azure</td>
<td>Subscription Owner</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#office-365-details">Office Domain </a></td>
<td>Office 365 portal</td>
<td>Office 365 user with Exchnage Admin and SharePoint Admin role</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#enable-mfa-and-create-application-password">Office Admin Email Id  </a></td>
<td>Office 365 portal</td>
<td>Office 365 user with Exchnage Admin and SharePoint Admin role</td>
</tr>
<tr>
<td><a href=".././office365Subscription/#enable-mfa-and-create-application-password">Office 365 App Password</a></td>
<td>Office 365 portal</td>
<td>Office 365 user with Exchnage Admin and SharePoint Admin role</td>
</tr>
</tbody>
</table>
<h4 id="cloudneeti-license-and-account-details">Cloudneeti license and account details</h4>
<p>Login to Cloudneeti portal as a License Admin.</p>
<h5 id="license-id">License id</h5>
<ol>
<li>Navigate to <strong>Features and Quota​s</strong> under <strong>Configurations</strong></li>
<li>Copy license ID and paste to notepad.
    <img alt="License id" src="../../images/onboardingOffice365Subscription/License_Id.png#thumbnail" /></li>
</ol>
<h5 id="account-id">Account id</h5>
<ol>
<li>Navigate to <strong>Cloud Accounts</strong> in <strong>Configurations</strong></li>
<li>Copy account ID and paste to notepad.
    <img alt="Manage Accounts" src="../../images/onboardingOffice365Subscription/Manage_Accounts.png#thumbnail" /></li>
</ol>
<h4 id="office-365-details">Office 365 details</h4>
<p>Office Admin id and office domain can be retrieved from the user id used for
signing-in like userid\@domain.com.</p>
<p>Cloudneeti platform queries and processes Office 365 meta-data using a
non-interactive login credential. As the background job processing is
non-interactive it’ll require a service account credential. The following is the
process outlined to create a secure service account credential.</p>
<p>Sign into your Office 365 portal (e.g. <a href="https://outlook.office.com/mail/inbox">https://outlook.office.com/mail/inbox</a>)
as global administrator.</p>
<h5 id="create-office-365-user">Create Office 365 user</h5>
<h6 id="1-create-office-365-user-with-roles-sharepoint-administrator-and-exchange-administrator">1. Create Office 365 user with roles <strong>SharePoint Administrator</strong> and <strong>Exchange Administrator</strong></h6>
<ol>
<li>Login to <a href="https://www.office.com" target="_blank">office portal</a> with Office Administrator role</li>
<li>
<p>Click <strong>Admin</strong> to go to <strong>M365 Admin center</strong></p>
<p><img alt="Admin Center" src="../../images/onboardingOffice365Subscription/M365AdminCenter.png#thumbnail" /></p>
</li>
<li>
<p>Select <strong>Users</strong> </p>
</li>
<li>Click <strong>Add a user</strong></li>
<li>
<p>Fill in Basics and Product License details</p>
<p><img alt="Basic info" src="../../images/onboardingOffice365Subscription/addUser.png#thumbnail" /></p>
</li>
<li>
<p>Select <strong>SharePoint Administrator</strong> and <strong>Exchange Administrator</strong> from Common specialist roles</p>
</li>
<li>
<p>Click <strong>Finish adding</strong></p>
<p><img alt="Basic info" src="../../images/onboardingOffice365Subscription/AdminRoles_Save.png#thumbnail" /></p>
</li>
</ol>
<h6 id="2-assign-user-with-compliance-manager-role">2. Assign User with Compliance Manager role</h6>
<ol>
<li>
<p>Login to <a href="https://portal.azure.com/" target="_blank">Azure portal</a> with AD admin role</p>
</li>
<li>
<p>Navigate to the User created</p>
<p><img alt="Basic info" src="../../images/onboardingOffice365Subscription/CM1.png#thumbnail" /></p>
</li>
<li>
<p>Assign <strong>Compliance Manager</strong> role to the User</p>
<p><img alt="Basic info" src="../../images/onboardingOffice365Subscription/CM2.png#thumbnail" /></p>
<p><img alt="Basic info" src="../../images/onboardingOffice365Subscription/CM3.png#thumbnail" /></p>
</li>
</ol>
<h5 id="enable-mfa-and-create-application-password">Enable MFA and create application password</h5>
<p>Follow <a href="https://docs.microsoft.com/en-us/office365/admin/security-and-compliance/set-up-multi-factor-authentication?view=o365-worldwide#set-up-multi-factor-authentication-in-the-new-microsoft-365-admin-center" target="_blank">link</a> to enable MFA</p>
<p>Sign into your Office 365 portal (e.g. <a href="https://outlook.office.com/mail/inbox">https://outlook.office.com/mail/inbox</a>)
as user created above <a href=".././office365Subscription/#create-office-365-user">step</a></p>
<ol>
<li>Choose <strong>My Account Settings</strong>
    <img alt="My Account Settings" src="../../images/onboardingOffice365Subscription/My_Account_Settings.png#thumbnail" /></li>
<li>Select <strong>Security &amp; privacy</strong></li>
<li>Select <strong>Additional security verification</strong>
    Note : If you do not see additional security configuration them make sure you have enabled MFA for your user. </li>
<li>Click <strong>Create and manage app passwords</strong>
    <img alt="Create and manage app passwords" src="../../images/onboardingOffice365Subscription/Manage_Password.png#thumbnail" /></li>
<li>Select <strong>app passwords</strong></li>
<li>Click <strong>create</strong></li>
<li>Get an app password
    <img alt="App Password" src="../../images/onboardingOffice365Subscription/App_Password.png#thumbnail" /></li>
</ol>
<h4 id="generate-cloudneeti-api-key">Generate Cloudneeti API key</h4>
<h5 id="sign-up-on-cloudneeti-api-portal">Sign-up on Cloudneeti API portal.</h5>
<ol>
<li>
<p>Go to <a href="https://portal.cloudneeti.com/" target="_blank">API portal</a> and Sign up.</p>
</li>
<li>
<p>Fill the required fields in the sign-up form</p>
</li>
<li>
<p>You will receive a confirmation mail for sign-up, Click on the confirmation
    link.</p>
</li>
<li>
<p>The confirmation link will ask you for change password (info: You can use
    the password your used when signing up)</p>
</li>
<li>
<p>You are signed up successfully</p>
</li>
</ol>
<h5 id="retrieve-and-activate-api-key">Retrieve and activate API key</h5>
<p>Retrieve and activate your API key using the Cloudneeti API portal</p>
<ol>
<li>Click on <strong>PRODUCTS</strong></li>
<li>Select <strong>Unlimited</strong>
    <img alt="Cloudneeti API" src="../../images/onboardingOffice365Subscription/Cloudneeti_API.png#thumbnail" /></li>
<li>Click on <strong>Subscribe</strong>
    <img alt="Subscribe" src="../../images/onboardingOffice365Subscription/API_Subscribe.png#thumbnail" /></li>
</ol>
<p>This will notify Cloudneeti to activate your API subscription access. Please
wait for activation to be done. When Cloudneeti activates your subscription, you
will get an email notification.</p>
<p>Once you receive the confirmation, proceed with the following steps.</p>
<ol>
<li>Click on <strong>Username</strong></li>
<li>Select <strong>Profile</strong></li>
<li>Click on <strong>Show</strong></li>
<li>Copy the <strong>Primary key</strong> to your notepad.
    <img alt="Primary key" src="../../images/onboardingOffice365Subscription/Primary_key.png#thumbnail" /></li>
</ol>
<h4 id="cloudneeti-artifacts-and-data-collector-details">Cloudneeti artifacts and data collector details</h4>
<p>Contact Cloudneeti Team for:</p>
<ul>
<li>
<p>Cloudneeti environment</p>
</li>
<li>
<p>ArtifactsName</p>
</li>
<li>
<p>DataCollectorVersion</p>
</li>
<li>
<p>ArtifactsAccessKey</p>
</li>
</ul>
<h5 id="azure-details">Azure details</h5>
<p>Login to Azure portal <a href="https://portal.azure.com" target="_blank">https://portal.azure.com</a> as subscription owner.</p>
<h5 id="azure-subscription-id">Azure Subscription ID</h5>
<ol>
<li>Choose your Azure AD tenant by selecting your <strong>Azure subscription</strong> in the
    top right corner of the page</li>
<li>Select <strong>Default Directory</strong>
    <img alt="Default Directory" src="../../images/onboardingOffice365Subscription/Default_Directory.png#thumbnail" /></li>
<li>Click on <strong>Subscriptions</strong> (1) on the primary menu</li>
<li>Select the desired <strong>Azure subscription</strong> (2)
    <img alt="Azure subscription" src="../../images/onboardingOffice365Subscription/Azure_Subscription.png#thumbnail" /></li>
<li>Copy <strong>Subscription ID</strong> to a notepad
    <img alt="Subscription ID" src="../../images/onboardingOffice365Subscription/Subscription_Id.png#thumbnail" /></li>
</ol>
<h3 id="32-provision-office-365-data-collector">3.2 Provision Office 365 data collector</h3>
<p>Login to Azure portal <a href="https://portal.azure.com" target="_blank">https://portal.azure.com</a> as Subscription Contributor or
Subscription Owner access.</p>
<p>Switch to Azure AD with the Azure Subscription with pre-requisite access.</p>
<ol>
<li>Open <strong>CloudShell</strong></li>
<li>Click on <strong>Cloudshell</strong> icon on the navigation bar to open Cloudshell</li>
<li>Choose PowerShell from shell drop down</li>
<li>Select <strong>storage</strong>
    <img alt="CloudShell" src="../../images/onboardingOffice365Subscription/CloudShell.png#thumbnail" /></li>
<li>Execute below command in Cloudshell to download the Cloudneeti data
    collector provisioning script.
    <pre>
    <code><code>wget https://raw.githubusercontent.com/Cloudneeti/docs_cloudneeti/master/scripts/Provision-M365DataCollector.ps1 -O Provision-M365DataCollector.ps1</code></code>
    </pre></li>
<li>Switch to the User directory
    <pre>
    <code><code>cd $User</code></code>
    </pre></li>
<li>Run provisioning script with inline parameters
    <pre>
    <code><code>./Provision-M365DataCollector.ps1 `
            -CloudneetiLicenseId &lt;Cloudneeti License Id&gt; `
            -CloudneetiAccountId &lt;Cloudneeti Account Id&gt; `
            -CloudneetiEnvironment &lt;Cloudneeti Environment&gt; `
            -CloudneetiApplicationId &lt;Cloudneeti Data Collector Registered Application Id&gt; `
            -ArtifactsName &lt;Cloudneeti office 365 Data Collector Artifact Name&gt; `
            -DataCollectorVersion &lt;Cloudneeti Office 365 Data Collector Version&gt; `
            -OfficeDomain &lt;Office 365 Domain Name&gt; `
            -OfficeDirectoryId &lt;Office 365 Directory Id&gt; `
            -OfficeAdminEmailId &lt;Office 365 Administator Email Id&gt; `
            -AzureSubscriptionId &lt;Azure Subscription Id where office 365 datacollector resouces will be created&gt; `
            -DataCollectorName &lt;Office 365 Data Collector Name&gt; `
            -Location &lt;Default EastUs2&gt;</code></code>
    </pre>
Note: Contact Cloudneeti Team for ArtifactsName, DataCollectorVersion and
ArtifactsAccessKey</li>
<li>The script will execute and prompt you for below details:</li>
<li>Cloudneeti API key </br></li>
<li>Cloudneeti Data collector application secret </br></li>
<li>Cloudneeti Office 365 data collector artifacts storage access Key </br></li>
<li>
<p>User Password or Office 365 App Password  </p>
<ul>
<li>User Password </br>
  Advanced security configuration done using <strong>User Password</strong> will enable all 44 policies listed <a href=".././office365Subscription/#advanced-security-configuration">here.</a>)</li>
<li>Office 365 App Password </br>
  Advanced security configuration done using <strong>Office 365 App Password</strong> will <strong>not enable 18 policies</strong> of category M365 - Identity listed <a href=".././office365Subscription/#advanced-security-configuration">here.</a>)</li>
</ul>
</li>
<li>
<p>This will create a runbook inside automation account</p>
</li>
</ol>
<h3 id="33-apply-delete-lock">3.3 Apply delete lock</h3>
<p>Apply delete lock to prevent accidental deletion of the data collection resource
group in your Azure Subscription.</p>
<ol>
<li>
<p>Navigate to M365 data collector resource group
    (<strong>cloudneeti-m365-datacollector-rg</strong>).</p>
</li>
<li>
<p>Click on <strong>Locks</strong> (1)</p>
</li>
<li>
<p>Click <strong>Add</strong> (2)</p>
</li>
<li>
<p>Enter <strong>Lock name</strong> DoNotDelete (3)</p>
</li>
<li>
<p>Select <strong>Lock type</strong> as Delete (4)</p>
</li>
<li>
<p>Add <strong>Notes</strong> (Do not delete M365 data collector resource group) (5)</p>
</li>
<li>
<p>Click <strong>OK</strong> (6)
    <img alt="Apply Delete Lock" src="../../images/onboardingOffice365Subscription/Locks.png#thumbnail" /></p>
</li>
</ol>
<h3 id="34-modify-the-data-collection-schedule">3.4 Modify the data collection schedule</h3>
<p>Set the automation account schedule before the daily Cloudneeti data collection
time.</p>
<ol>
<li>Go to <strong>M365 data collector</strong> resource group</li>
<li>Select <strong>Automation account</strong></li>
<li>Click on <strong>Schedules</strong></li>
<li>Select <strong>Schedule</strong>
    <img alt="Schedule" src="../../images/onboardingOffice365Subscription/Schedule.png#thumbnail" /></li>
<li>Modify the schedule <strong>Time</strong> (set time about 1 hour before the daily
    Cloudneeti data collection time)</li>
<li>Click <strong>Save</strong>
    <img alt="Modify and Save" src="../../images/onboardingOffice365Subscription/Modify_Save.png#thumbnail" /></li>
</ol>
<p>Cloudneeti portal will show details for policies from next scan.</p>
<!-- ## NEXT STEPS

[Configure Notifications](../../administratorGuide/configureNotifications/) -->

<h2 id="security-policies-that-require-permissions">Security Policies that Require Permissions</h2>
<p>The following Security Policies will be excluded if advanced security
configurations are not done.</p>
<h3 id="micorosft-graph-permission-devicemanagementconfigurationreadall">Micorosft graph permission - DeviceManagementConfiguration.Read.All</h3>
<p>Microsoft graph permission DeviceManagementConfiguration.Read.All is required to collect data for device related security policies listed below.</p>
<table>
<thead>
<tr>
<th><strong>Category</strong></th>
<th><strong>Policy Title</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>M365 - Device</td>
<td>Ensure that mobile devices require complex passwords with atleast two character sets to prevent brute force attacks</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that mobile device encryption is enabled to prevent unauthorized access to mobile data</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Require mobile devices to manage email profile</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that mobile devices require a complex password with a minimum password length to prevent brute force attacks</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that mobile devices are set to never expire passwords</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Require mobile devices to use a password</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that users cannot connect from devices that are jail broken or rooted</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that mobile devices require complex passwords to prevent brute force attacks</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Enable mobile devices to wipe on multiple sign-in failures to prevent brute force compromise</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that settings are enable to lock multiple devices after a period of inactivity to prevent unauthorized access</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that mobile device password reuse is prohibited</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Compliance Policy for iOS</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Compliance Policy for Android</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Compliance Policy for Android for Work</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Compliance Policy for Windows</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Compliance Policy for macOS</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Configuration Profile for iOS</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Configuration Profile for Android</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Configuration Profile for Android for Work</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Configuration Profile for Windows</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Configuration Profile for macOS</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Enable Enhanced Jailbreak Detection in Microsoft Intune</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Ensure that devices connecting have local firewall enabled</td>
</tr>
</tbody>
</table>
<h3 id="micorosft-graph-permission-applicationreadall">Micorosft graph permission - Application.Read.All</h3>
<p>Microsoft graph permission Application.Read.All is required to collect data for application related security policies listed below.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Policy Title</th>
</tr>
</thead>
<tbody>
<tr>
<td>M365 - Identity</td>
<td>Ensure that Service Principal Certificates are renewed before it expires</td>
</tr>
<tr>
<td>M365 - Apps</td>
<td>Ensure that AD Application keys are rotated before they expires</td>
</tr>
</tbody>
</table>
<h3 id="micorosft-graph-permission-userreadall">Micorosft graph permission - User.Read.All</h3>
<p>Microsoft graph permission User.Read.All is required to collect data for user related security policies listed below.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Policy Title</th>
</tr>
</thead>
<tbody>
<tr>
<td>M365 - Identity</td>
<td>Enforce the policy to set Password to ‘always' expire in Azure Active Directory for all Organization Users</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that there are no guest users</td>
</tr>
</tbody>
</table>
<h3 id="micorosft-graph-permission-devicemanagementappsreadall">Micorosft graph permission - DeviceManagementApps.Read.All</h3>
<p>Microsoft graph permission DeviceManagementApps.Read.All is required to collect data for device related security policies listed below.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Policy Title</th>
</tr>
</thead>
<tbody>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune App Protection Policy for iOS</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune App Protection Policy for Android</td>
</tr>
<tr>
<td>M365 - Device</td>
<td>Create a Microsoft Intune Windows Information Protection Policy</td>
</tr>
</tbody>
</table>
<h3 id="advanced-security-configurations">Advanced security configurations</h3>
<p>The advanced security policy data collector enables the following 43 policies as
available in the Center for Internet Security (CIS) Microsoft 365 benchmark
(Reference
<a href="https://www.cloudneeti.com/2019/01/assure-microsoft-365-security-and-compliance-with-cloudneeti/" target="_blank">here</a>).</p>
<p>Advanced security configuration done using Office 365 App Password will not enable 18 policies of category M365 - Identity listed in below table.</p>
<table>
<thead>
<tr>
<th><strong>Category</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Account / Authentication</td>
<td>Ensure modern authentication for SharePoint applications is required</td>
</tr>
<tr>
<td>Application Permissions</td>
<td>Ensure calendar details sharing with external users is disabled</td>
</tr>
<tr>
<td>Application Permissions</td>
<td>Ensure O365 ATP SafeLinks for Office Applications is Enabled</td>
</tr>
<tr>
<td>Application Permissions</td>
<td>Ensure Office 365 ATP for SharePoint, OneDrive, and Microsoft Teams is Enabled</td>
</tr>
<tr>
<td>Data Management</td>
<td>Ensure that external users cannot share files, folders, and sites they do not own</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure that DKIM is enabled for all Exchange Online Domains</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure the Common Attachment Types Filter is enabled</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure that SPF records are published for all Exchange Domains</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure DMARC Records for all Exchange Online domains are published</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure notifications for internal users sending malware is Enabled</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure Exchange Online Spam Policies are set correctly</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure mail transport rules do not whitelist specific domains</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure Client Rules Forwarding Block is enabled</td>
</tr>
<tr>
<td>Email Security / Exchange Online</td>
<td>Ensure that an anti-phishing policy has been created</td>
</tr>
<tr>
<td>Auditing</td>
<td>Enable Microsoft 365 audit log search</td>
</tr>
<tr>
<td>Auditing</td>
<td>Ensure account provisioning activity report is reviewed weekly</td>
</tr>
<tr>
<td>Auditing</td>
<td>Ensure the spoofed domains report is reviewed weekly</td>
</tr>
<tr>
<td>Auditing</td>
<td>Ensure user role group changes is reviewed at least every week</td>
</tr>
<tr>
<td>Storage</td>
<td>Ensure document sharing is being controlled by domains with whitelist or blacklist</td>
</tr>
<tr>
<td>M365 - Account / Authentication</td>
<td>Ensure modern authentication for Exchange Online is enabled</td>
</tr>
<tr>
<td>M365 - Data Management</td>
<td>Use custom sensitive infromation type classification for information protection</td>
</tr>
<tr>
<td>M365 - Email Security / Exchange Online</td>
<td>Ensure MailTips are enabled for end users</td>
</tr>
<tr>
<td>M365 - Email Security / Exchange Online</td>
<td>Ensure basic authentication for Exchange Online is disabled</td>
</tr>
<tr>
<td>M365 - Storage</td>
<td>Block OneDrive for Business sync from unmanaged devices</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Number of methods required to reset' is set to '2'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Number of days before users are asked to re-confirm their authentication information' is not set to '0'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Notify all admins when other admins reset their password?' is set to 'Yes'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Notify users on password resets?' is set to 'Yes'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users can consent to apps accessing company data on their behalf' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users can add gallery apps to their Access Panel' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users can register applications' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Guest user permissions are limited' is set to 'Yes'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Members can invite' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Guests can invite' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Restrict access to Azure AD administration portal' is set to 'Yes'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Self-service group management enabled' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users can create security groups' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users who can manage security groups' is set to 'None'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users can create Office 365 groups' is set to 'No'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Users who can manage Office 365 groups' is set to 'None'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Enable All Users group' is set to 'Yes'</td>
</tr>
<tr>
<td>M365 - Identity</td>
<td>Ensure that 'Require Multi-Factor Auth to join devices' is set to 'Yes'</td>
</tr>
<tr>
<td>M365 - Data</td>
<td>Enable audit data recording</td>
</tr>
<tr>
<td>M365 - Data</td>
<td>Ensure Advanced Threat Protection safe attach policy is Enabled</td>
</tr>
</tbody>
</table>
<!-- | M365 - Data                             | Ensure Advanced Threat Protection safe links policy is Enabled                                                       | -->

<div class="policy-json-code">
<pre>
<code>
    [
    {
        "ttl": xxxxxxxxx,
        "id": "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
        "_rid": "SvAwAJo4UAdIVAQAAAAADA==",
        "_self": "dbs/SvAwAA==/colls/SvAwAJo4UAc=/docs/SvAwAJo4UAdIVAQAAAAADA==/",
        "_etag": "\"1900267d-0000-0100-0000-5d1ee0810000\"",
        "AccountId": "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxx",
        "Type": "M365ScanedData",
        "PartitionKey": "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXx",
        "ScanedDataFromPS": [
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "CalExtSharing",
                "PassedResourceCount": 1
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "ATPSafeLinks",
                "PassedResourceCount": 0
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "ATPEnabled",
                "PassedResourceCount": 1
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "AttachmentFilter",
                "PassedResourceCount": 0
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "OutbondSpam",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "TransportRule",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "ClientRuleFrwd",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "AntiPhishing",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "DKIMExchange",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "InternalMalware",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "AuditLogSearch",
                "PassedResourceCount": 1
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "UserRoleGroup",
                "PassedResourceCount": 0
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "AddedAccount",
                "PassedResourceCount": 1
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "DomainSpoof",
                "PassedResourceCount": 1
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "ModernAuthSPO",
                "PassedResourceCount": 0
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "ExtUserSharing",
                "PassedResourceCount": 0
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "DomainControl",
                "PassedResourceCount": 0
            },
            {
                "Status": "Green",
                "TotalResourceCount": 1,
                "PolicyId": "SPFExchange",
                "PassedResourceCount": 1
            },
            {
                "Status": "Red",
                "TotalResourceCount": 1,
                "PolicyId": "DMARCExchange",
                "PassedResourceCount": 0
            }
        ],
        "ContractId": "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
        "LastModified": "0001-01-01T00:00:00",
        "LastModifiedBy": null,
        "AppVersion": "xxx",
        "_attachments": "attachments/",
        "_ts": xxxxxxx
    }
]
</code>
</pre>
</div>

<h2 id="offboarding">OFFBOARDING</h2>
<h3 id="delete-registered-cloudneeti-application">Delete registered Cloudneeti Application</h3>
<p>Cloudneeti Application within Customer’s Active Directory is removed which eventually will remove permissions, roles assigned on subscription/subscriptions. This will stop data collection for related cloud
accounts – Azure subscriptions related to Office 365 accounts in Cloudneeti.</p>
<ol>
<li>
<p>Go to <strong>Azure Active Directory</strong></p>
</li>
<li>
<p>Click on <strong>App Registration</strong></p>
</li>
<li>
<p>Select <strong>Cloudneeti Application</strong></p>
</li>
<li>
<p>Click on <strong>Delete</strong> to remove Cloudneeti Application registration</p>
<p><img alt="Apply Delete Lock" src="../../images/onboardingOffice365Subscription/DeleteAppReg.png#thumbnail" /></p>
</li>
</ol>
<h3 id="delete-office365-advanced-security-policy-data-collector">Delete Office365 Advanced Security Policy Data Collector</h3>
<p>Deletion of the advanced security policy data collector within Customer’s Active
Directory is removed which eventually will remove permissions, roles assigned on
subscription/subscriptions. This will stop data collection for related cloud
accounts in Cloudneeti</p>
<ol>
<li>
<p>Navigate to M365 data collector resource group
    (<strong>cloudneeti-m365-datacollector-rg</strong>).</p>
</li>
<li>
<p>Click <strong>Locks</strong> (1)</p>
</li>
<li>
<p><strong>Delete</strong> lock “DoNotDelete” (2)</p>
</li>
<li>
<p><strong>Select</strong> and <strong>Delete Automation account</strong> within resource group
    <strong>cloudneeti-m365-datacollector-rg</strong></p>
<p><img alt="Apply Delete Lock" src="../../images/onboardingOffice365Subscription/DeleteRGLock.png#thumbnail" /></p>
</li>
</ol>
<h3 id="delete-cloud-account-in-cloudneeti-application">Delete cloud account in Cloudneeti application</h3>
<p>Please send a request to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#99;&#108;&#111;&#117;&#100;&#110;&#101;&#101;&#116;&#105;&#46;&#99;&#111;&#109;">&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#99;&#108;&#111;&#117;&#100;&#110;&#101;&#101;&#116;&#105;&#46;&#99;&#111;&#109;</a> to delete this cloud account
under your license.</p></article></div></div></main><footer class="md-footer"><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">&copy; 2020 Cloudneeti.All Rights Reserved. | <a href="https://www.cloudneeti.com/privacy-policy-2/" target="_blank"> Privacy Policy</a> | <a href="https://www.cloudneeti.com/terms-of-use/" target="_blank"> Terms of Use</a></div></div></div></div></footer>

</div><script src="../../assets/javascripts/application.d5a09f94.js"></script><script>app.initialize({version:"1.1.2",url:{base:"../.."}})</script><script src="../../javascripts/custom.js"></script></body></html>